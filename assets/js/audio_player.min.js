var mediaPlayer=$("#media-player"),title=$("#track-title"),dur_main=$("#dur-main")[0],curr_main=$("#curr-main"),players=$("audio"),playing=-1,played=[],played_pointer=-1,repeat=!1;function autoplay(e){var a=players.eq(e),t=a.parent().parent();played=[],played_pointer=-1,t.addClass("playing active"),a[0].play(),a[0].addEventListener("ended",function(){autoplay(++e)}),t.find(".close").click(function(){autoplay(++e)})}function mDur(e){var a=document.getElementById("player-"+e);document.getElementById("dur-"+e).max=a.duration,dur_main.max=a.duration}function mPlay(e){var a=document.getElementById("player-"+e),t=document.getElementById("dur-"+e),n=$("#curr-"+e);t.value=a.currentTime,n.html(a.currentTime),dur_main.value=a.currentTime,curr_main.html(a.currentTime)}function mSet(e,a){var t=document.getElementById(e),n=a,i=a.parent().prev().find(".current-time");t.currentTime=n.val(),i.html(t.currentTime)}$(".player").on("click",function(e){var a=$(e.target),t=a.parent(),n=t.prev();if(a.hasClass("vol")){var i=n[0].volume.toFixed(1),l=$(".vol-incr"),r=$(".vol-decr");1==i?l.css("opacity",.75):0==i?r.css("opacity",.75):$(".vol").css("opacity",1),t.find(".volume span").html(i)}}),$(".player").each(function(){var e=$(this),a=e.index(),t=e.find("audio"),n=(t[0].currentTime,t[0].duration,$("#curr-"+t.attr("id").split("-")[1])),i=($("#dur-"+t.attr("id").split("-")[1]),e.parent());e.change(function(){n.html(t[0].currentTime)}),t[0].addEventListener("ended",function(){i.removeClass("playing").removeClass("active"),e.eq(a++)?autoplay(a++):(document.title="!@#$%",playing=-1),mediaPlayer.removeClass("paused")}),t[0].addEventListener("play",function(){document.title="Now playing: "+t.data("title"),title.html("Now playing: "+t.data("title")),playing=$(this).parent().parent().index(),repeat?repeat=!1:(played.push(playing),played_pointer++),mediaPlayer.addClass("active").removeClass("paused").addClass("playing"),i.addClass("playing").addClass("active").removeClass("paused")}),t[0].addEventListener("pause",function(){document.title="!@#$%",mediaPlayer.removeClass("playing").addClass("paused"),i.removeClass("playing").addClass("paused")})}),$("#playall").click(function(){$(".music.playing").each(function(){$(this).find("audio")[0].pause()}),$(".tag.active").length>0&&(players=$(".match audio")),players.first()[0].play()}),$(".music").click(function(e){if($(e.target).hasClass("close")){var a=$(this).find("audio");a[0].pause(),a[0].currentTime=0,a.removeClass("active").removeClass("paused").removeClass("playing"),mediaPlayer.removeClass("active")}}),mediaPlayer.click(function(e){var a=$(e.target),t=-1;if(a.hasClass("next")||a.hasClass("prev")){var n=players.eq(playing),i=n.parent().parent();a.hasClass("next")?-1!=played_pointer&&played_pointer<played.length-1?(t=played[++played_pointer],repeat=!0):players.eq(playing+1).length>0&&(t=playing+1):played_pointer>0&&(repeat=!0,t=played[--played_pointer]),-1!=t&&(i.removeClass("active"),i.hasClass("playing")&&n[0].pause(),n[0].currentTime=0,players.eq(t)[0].play())}});