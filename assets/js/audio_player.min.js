var mediaPlayer=$("#media-player"),title=$("#track-title"),dur_main=$("#dur-main")[0],curr_main=$("#curr-main"),players=$("audio"),playing=-1,played=[],played_pointer=-1,repeat=!1;function autoplay(e){var a=players.eq(e),t=a.closest(".music");played=[],played_pointer=-1,t.addClass("playing active"),a[0].play(),a[0].addEventListener("ended",function(){autoplay(++e)}),t.find(".close").click(function(){autoplay(++e)})}function mDur(e){var a=document.getElementById("player-"+e);document.getElementById("dur-"+e).max=a.duration,dur_main.max=a.duration}function mPlay(e){var a=document.getElementById("player-"+e),t=document.getElementById("dur-"+e),i=$("#curr-"+e);t.value=a.currentTime,i.html(a.currentTime),dur_main.value=a.currentTime,curr_main.html(a.currentTime)}function mSet(e,a){var t=document.getElementById(e),i=a,l=a.parent().prev().find(".current-time");t.currentTime=i.val(),l.html(t.currentTime)}$(".player").on("click",function(e){var a=$(e.target),t=a.parent(),i=t.prev();if(a.hasClass("vol")){var l=i[0].volume.toFixed(1),n=$(".vol-incr"),r=$(".vol-decr");1==l?n.css("opacity",.75):0==l?r.css("opacity",.75):$(".vol").css("opacity",1),t.find(".volume span").html(l)}}),$(".player").each(function(){var e=$(this),a=e.index(),t=e.find("audio"),i=(t[0].currentTime,t[0].duration,$("#curr-"+t.attr("id").split("-")[1])),l=($("#dur-"+t.attr("id").split("-")[1]),e.closest(".music"));e.change(function(){i.html(t[0].currentTime)}),t[0].addEventListener("ended",function(){l.removeClass("playing").removeClass("active"),$("footer").removeClass("active"),e.eq(a++)?autoplay(a++):(document.title="!@#$%",playing=-1),mediaPlayer.removeClass("paused")}),t[0].addEventListener("play",function(){document.title="Now playing: "+t.data("title"),title.html("Now playing: "+t.data("title")),$("footer").addClass("active"),playing=$(this).closest(".music").index(),repeat?repeat=!1:(played.push(playing),played_pointer++),mediaPlayer.addClass("active").removeClass("paused").addClass("playing"),l.addClass("playing").addClass("active").removeClass("paused")}),t[0].addEventListener("pause",function(){document.title="!@#$%",mediaPlayer.removeClass("playing").addClass("paused"),l.removeClass("playing").addClass("paused")})}),$("#playall").click(function(){$(".music.playing").each(function(){$(this).find("audio")[0].pause()}),$(".tag.active").length>0&&(players=$(".match audio")),players.first()[0].play()}),$(".music").click(function(e){if($(e.target).hasClass("close")){var a=$(this).find("audio");a[0].pause(),a[0].currentTime=0,a.removeClass("active").removeClass("paused").removeClass("playing"),mediaPlayer.removeClass("active")}}),mediaPlayer.click(function(e){var a=$(e.target),t=-1;if(a.hasClass("next")||a.hasClass("prev")){var i=players.eq(playing),l=i.closest(".music");a.hasClass("next")?-1!=played_pointer&&played_pointer<played.length-1?(t=played[++played_pointer],repeat=!0):players.eq(playing+1).length>0&&(t=playing+1):played_pointer>0&&(repeat=!0,t=played[--played_pointer]),-1!=t&&(l.removeClass("active"),l.hasClass("playing")&&i[0].pause(),i[0].currentTime=0,players.eq(t)[0].play())}});